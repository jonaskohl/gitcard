(()=>{function e(e){const t={facebook:"https://fb.me/{}",instagram:"https://instagram.com/{}",twitter:"https://twitter.com/{}",github:"https://github.com/{}",telegram:"https://t.me/{}",keybase:"https://keybase.io/{}",deviantart:"https://deviantart.com/{}",tumblr:"https://{}.tumblr.com/",artstation:"https://artstation.com/{}",reddit:"https://reddit.com/user/{}",youtube:"https://youtube.com/channel/{}",vimeo:"https://vimeo.com/{}",mail:"mailto:{}",web:"{}"},o={facebook:"Facebook",instagram:"Instagram",twitter:"Twitter",github:"GitHub",telegram:"Telegram",keybase:"Keybase",deviantart:"DeviantArt",tumblr:"Tumblr",artstation:"ArtStation",reddit:"Reddit",youtube:"YouTube",vimeo:"Vimeo",mail:"Email",web:"Website"},r=["name","pronouns","bio","links","colors"],n={name:null,pronouns:null,bio:null,links:[],colors:["#000","#fff"]},c=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n");let s=0,l=!1,i=!1;for(;c.length>0&&!(s>=r.length);){const e=c.shift().trim();if(!(e.length<1))if(l)if("end;"===e)l=!1,s++;else{const r=e.split("@"),c=r.shift().toLowerCase(),s=r.join("@");Object.keys(t).indexOf(c)>-1?n.links.push({link:t[c].replace(/\{\}/,encodeURI(s)),site:c,name:o[c]}):console.warn("Unknown site",c)}else if("links:"===e)l=!0;else{const t=r[s];if("pronouns"===t){if("-omit-"!==e.toLowerCase()){let t,o="https://pronoun.is/";if(e.indexOf(" or ")>-1){t=e.split(" or ");const r=[];for(let e=1;e<t.length;e++)r.push(encodeURIComponent(t[e]));const n="?or="+r.join("&or=");o+=t[0]+n}else t=[e],o+=e;n.pronouns={link:o,text:e}}}else"colors"===t?(i||(i=!0,n.colors=[]),n.colors.push(e)):n[t]=e;s++,s=Math.min(s,r.length-1)}}!function(e){const t=document.querySelector("#card"),o=t.querySelector("#card__name"),r=t.querySelector("#card__pronouns"),n=t.querySelector("#card__pronouns__link"),c=t.querySelector("#card__bio"),s=t.querySelector("#card__links");o.appendChild(document.createTextNode(e.name)),n.href=e.pronouns.link,n.appendChild(document.createTextNode(e.pronouns.text)),r.appendChild(n),e.links.forEach(e=>{const t=document.createElement("a");t.href=e.link,t.target="_blank",t.title=e.name,fetch("/img/icons/"+e.site+".svg").then(e=>e.text()).then(e=>{t.innerHTML=e}),s.appendChild(t)}),c.appendChild(document.createTextNode(e.bio)),e.colors.length>0&&(document.documentElement.style.setProperty("--card-foreground-color",e.colors[0]),e.colors.length>1&&document.documentElement.style.setProperty("--card-background-color",e.colors[1]),e.colors.length>2&&document.documentElement.style.setProperty("--card-link-color",e.colors[2]),e.colors.length>3&&document.documentElement.style.setProperty("--card-link-hover-color",e.colors[3]))}(n)}window.card_preview?e(window.card_content):fetch("/api/v1/card/"+encodeURI(window.card_username)).then(e=>{if(200===e.status)return e.text();throw 404===e.status?new Error("No card was found for this user"):(e.text().then(e=>{console.error("Error loading card data.\nResponse body:\n"+e)}),new Error("Unexpected error. See JavaScript console for more information"))}).then(t=>{e(t)}).catch(e=>{const t=document.querySelector("#card"),o=t.querySelector("#card__name"),r=t.querySelector("#card__bio");o.innerText="Error displaying card",r.innerText=e.message})})();